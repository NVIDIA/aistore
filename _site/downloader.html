<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>DOWNLOADER | AIStore - distributed object storage</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="DOWNLOADER" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore" />
<meta property="og:description" content="AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore" />
<link rel="canonical" href="http://localhost:4000/aistore/downloader" />
<meta property="og:url" content="http://localhost:4000/aistore/downloader" />
<meta property="og:site_name" content="AIStore - distributed object storage" />
<script type="application/ld+json">
{"headline":"DOWNLOADER","@type":"WebPage","url":"http://localhost:4000/aistore/downloader","description":"AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/aistore/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/aistore/feed.xml" title="AIStore - distributed object storage" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/aistore/">AIStore - distributed object storage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">DOWNLOADER</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="" itemprop="datePublished">
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="why-downloader">Why Downloader?</h2>

<p>It is a well-known fact that some of the most popular AI datasets are available on the Internet.</p>

<blockquote>
  <p>See, for instance, <a href="https://arxiv.org/abs/1707.02968">Revisiting Unreasonable Effectiveness of Data in Deep Learning Era</a> - the paper lists a good number of very large and very popular datasets.</p>
</blockquote>

<p>Given that fact, it is only natural to ask the follow-up question: how to work with those datasets? And what happens if the dataset in question is <em>larger</em> than a single host? Meaning, what happens if it is large enough to warrant (and require) a distributed storage system?</p>

<p>Meet <strong>Internet downloader</strong> - an integrated part of the AIStore. AIStore cluster can be quickly deployed locally to the compute clients, and the <strong>downloader</strong> can then be used to quickly populate a specified AIS bucket with the objects from a given Internet location.</p>

<h2 id="download-request">Download Request</h2>

<p>AIS <em>Downloader</em> supports 4 types of download requests:</p>

<ul>
  <li><em>Single</em> - download a single object</li>
  <li><em>Multi</em> - download multiple objects provided by JSON map (string -&gt; string) or list of strings</li>
  <li><em>Range</em> - download multiple objects based on a given naming pattern</li>
  <li><em>Cloud</em> - given optional prefix and optional suffix, download matching objects from the specified cloud bucket</li>
</ul>

<blockquote>
  <p>Prior to downloading, make sure that AIS (destination) bucket already exists. See <a href="/docs/http_api.md">AIS API</a> for details on how to create, destroy, and list storage buckets. For Python-based clients, a better starting point could be <a href="/README.md#python-client">here</a>. Error is returned when provided bucket does not exist.</p>
</blockquote>

<p>The rest of this document is structured around all supported types of downloads:</p>

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#single-download">Single (object) download</a></li>
  <li><a href="#multi-download">Multi (object) download</a></li>
  <li><a href="#range-download">Range (object) download</a></li>
  <li><a href="#cloud-download">Cloud download</a></li>
  <li><a href="#aborting">Aborting</a></li>
  <li><a href="#status">Status (of the download)</a></li>
  <li><a href="#list-of-downloads">List of downloads</a></li>
  <li><a href="#remove-from-list">Remove from list</a></li>
</ul>

<h2 id="single-download">Single Download</h2>

<p>The request (described below) downloads a <em>single</em> object and is considered the most basic.
This request returns <em>id</em> on successful request which can then be used to check the status or abort the download job.</p>

<h3 id="request-query-parameters">Request Query Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>bucket</strong></td>
      <td><strong>string</strong></td>
      <td>Bucket where the downloaded object is saved to.</td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>provider</strong></td>
      <td><strong>string</strong></td>
      <td>Determines which bucket (<code class="highlighter-rouge">ais</code> or <code class="highlighter-rouge">cloud</code>) should be used. By default, locality is determined automatically</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td><strong>string</strong></td>
      <td>Description for the download request</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>timeout</strong></td>
      <td><strong>string</strong></td>
      <td>Timeout for request to external resource.</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>link</strong></td>
      <td><strong>string</strong></td>
      <td>URL of where the object is downloaded from.</td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>objname</strong></td>
      <td><strong>string</strong></td>
      <td>Name of the object the download is saved as. If no objname is provided, the name will be the last element in the URL’s path.</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>

<h3 id="sample-request">Sample Request</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Single object download</td>
      <td>POST /v1/download</td>
      <td><code class="highlighter-rouge">curl -Liv -X POST 'http://localhost:8080/v1/download?bucket=ubuntu&amp;objname=ubuntu.iso&amp;link=http://releases.ubuntu.com/18.04.1/ubuntu-18.04.1-desktop-amd64.iso'</code></td>
    </tr>
  </tbody>
</table>

<h2 id="multi-download">Multi Download</h2>

<p>A <em>multi</em> object download requires either a map or a list in JSON body:</p>
<ul>
  <li><strong>Map</strong> - in map, each entry should contain <code class="highlighter-rouge">custom_object_name</code> (key) -&gt; <code class="highlighter-rouge">external_link</code> (value). This format allows object names to not depend on automatic naming as it is done in <em>list</em> format.</li>
  <li><strong>List</strong> - in list, each entry should contain <code class="highlighter-rouge">external_link</code> to resource. Objects names are created from the base of the link (query parameters are stripped).</li>
</ul>

<p>This request returns <em>id</em> on successful request which can then be used to check the status or abort the download job.</p>

<h3 id="request-query-parameters-1">Request Query Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>bucket</strong></td>
      <td><strong>string</strong></td>
      <td>Bucket where the downloaded objects are saved to.</td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>provider</strong></td>
      <td><strong>string</strong></td>
      <td>Determines which bucket (<code class="highlighter-rouge">ais</code> or <code class="highlighter-rouge">cloud</code>) should be used. By default, locality is determined automatically.</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td><strong>string</strong></td>
      <td>Description for the download request</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>timeout</strong></td>
      <td><strong>string</strong></td>
      <td>Timeout for request to external resource.</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>

<h3 id="sample-request-1">Sample Request</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Multi download using object map</td>
      <td>POST /v1/download</td>
      <td><code class="highlighter-rouge">curl -Liv -X POST -H 'Content-Type: application/json' -d '{"train-labels.gz": "http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz", "t10k-labels-idx1.gz": "http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz", "train-images.gz": "http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz"}' http://localhost:8080/v1/download?bucket=yann-lecun</code></td>
    </tr>
    <tr>
      <td>Multi download using object list</td>
      <td>POST /v1/download</td>
      <td><code class="highlighter-rouge">curl -Liv -X POST -H 'Content-Type: application/json' -d '["http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz", "http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz", "http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz"]' http://localhost:8080/v1/download?bucket=yann-lecun</code></td>
    </tr>
  </tbody>
</table>

<h2 id="range-download">Range Download</h2>

<p>A <em>range</em> download retrieves (in one shot) multiple objects while expecting (and relying upon) a certain naming convention which happens to be often used.
This request returns <em>id</em> on successful request which can then be used to check the status or abort the download job.</p>

<p>Namely, the <em>range</em> download expects the object name to consist of prefix + index + suffix, as described below:</p>

<h3 id="range-format">Range Format</h3>

<p>Consider a website named <code class="highlighter-rouge">randomwebsite.com/some_dir/</code> that contains the following files:</p>
<ul>
  <li>object1log.txt</li>
  <li>object2log.txt</li>
  <li>object3log.txt</li>
  <li>...</li>
  <li>object1000log.txt</li>
</ul>

<p>To populate AIStore with objects in the range from <code class="highlighter-rouge">object200log.txt</code> to <code class="highlighter-rouge">object300log.txt</code> (101 objects total), use the <em>range</em> download.</p>

<h3 id="request-query-parameters-2">Request Query Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>bucket</strong></td>
      <td><strong>string</strong></td>
      <td>Bucket where the downloaded objects are saved to.</td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>subdir</strong></td>
      <td><strong>string</strong></td>
      <td>Subdirectory in the <strong>bucket</strong> where the downloaded objects are saved to.</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>provider</strong></td>
      <td><strong>string</strong></td>
      <td>Determines which bucket (<code class="highlighter-rouge">ais</code> or <code class="highlighter-rouge">cloud</code>) should be used. By default, locality is determined automatically.</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>description</strong></td>
      <td><strong>string</strong></td>
      <td>Description for the download request</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>timeout</strong></td>
      <td><strong>string</strong></td>
      <td>Timeout for request to external resource.</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>base</strong></td>
      <td><strong>string</strong></td>
      <td>Base URL of the object used to formulate the download URL.</td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>template</strong></td>
      <td><strong>string</strong></td>
      <td>Bash template describing names of the objects in the URL.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h3 id="sample-request-2">Sample Request</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Download a (range) list of objects</td>
      <td>POST /v1/download</td>
      <td><code class="highlighter-rouge">curl -Livg -X POST 'http://localhost:8080/v1/download?bucket=test321&amp;template=randomwebsite.com/some_dir/object{200..300}log.txt'</code></td>
    </tr>
    <tr>
      <td>Download a (range) list of objects into a subdirectory inside a bucket</td>
      <td>POST /v1/download</td>
      <td><code class="highlighter-rouge">curl -Livg -X POST 'http://localhost:8080/v1/download?bucket=test321&amp;subdir=some/subdir/&amp;template=randomwebsite.com/some_dir/object{200..300}log.txt'</code></td>
    </tr>
    <tr>
      <td>Download a (range) list of objects, selecting every tenth</td>
      <td>POST /v1/download</td>
      <td><code class="highlighter-rouge">curl -Livg -X POST 'http://localhost:8080/v1/download?bucket=test321&amp;template=randomwebsite.com/some_dir/object{1..1000..10}log.txt'</code></td>
    </tr>
  </tbody>
</table>

<p><strong>Tip:</strong> use <code class="highlighter-rouge">-g</code> option in curl to turn off URL globbing parser - it will allow to use <code class="highlighter-rouge">{</code> and <code class="highlighter-rouge">}</code> without escaping them.</p>

<h2 id="cloud-download">Cloud download</h2>

<p>A <em>cloud</em> download prefetches multiple objects which names match provided prefix and suffix and are contained in a given cloud bucket.</p>

<h3 id="request-query-parameters-3">Request Query Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>bucket</strong></td>
      <td><strong>string</strong></td>
      <td>Cloud bucket from which the data will be prefetched</td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>timeout</strong></td>
      <td><strong>string</strong></td>
      <td>Timeout for request to external resource</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>prefix</strong></td>
      <td><strong>string</strong></td>
      <td>Prefix of the objects names</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>suffix</strong></td>
      <td><strong>string</strong></td>
      <td>Suffix of the objects names</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>

<h3 id="sample-request-3">Sample Request</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Download a list of objects from cloud bucket</td>
      <td>POST /v1/download</td>
      <td><code class="highlighter-rouge">curl -L -X POST 'http://localhost:8080/v1/download?bucket=lpr-vision&amp;prefix=imagenet/imagenet_train-&amp;suffix=.tgz'</code></td>
    </tr>
  </tbody>
</table>

<h2 id="aborting">Aborting</h2>

<p>Any download request can be aborted at any time by making a <code class="highlighter-rouge">DELETE</code> request to <code class="highlighter-rouge">/v1/download/abort</code> with provided <code class="highlighter-rouge">id</code> (which is returned upon job creation).</p>

<h3 id="request-query-parameters-4">Request Query Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>id</strong></td>
      <td><strong>string</strong></td>
      <td>Unique identifier of download job returned upon job creation.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h3 id="sample-request-4">Sample Request</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Abort download</td>
      <td>DELETE /v1/download/abort</td>
      <td><code class="highlighter-rouge">curl -Liv -X DELETE 'http://localhost:8080/v1/download/abort?id=5JjIuGemR'</code></td>
    </tr>
  </tbody>
</table>

<h2 id="status">Status</h2>

<p>The status of any download request can be queried at any time using <code class="highlighter-rouge">GET</code> request with provided <code class="highlighter-rouge">id</code> (which is returned upon job creation).</p>

<h3 id="request-query-parameters-5">Request Query Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>id</strong></td>
      <td><strong>string</strong></td>
      <td>Unique identifier of download job returned upon job creation.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h3 id="sample-request-5">Sample Request</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Get download status</td>
      <td>GET /v1/download</td>
      <td><code class="highlighter-rouge">curl -Liv -X GET 'http://localhost:8080/v1/download?id=5JjIuGemR'</code></td>
    </tr>
  </tbody>
</table>

<h2 id="list-of-downloads">List of Downloads</h2>

<p>The list of all download requests can be queried at any time. Note that this has the same syntax as <a href="#status">Status</a> except the <code class="highlighter-rouge">id</code> parameter is empty.</p>

<h3 id="request-parameters">Request Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>regex</strong></td>
      <td><strong>string</strong></td>
      <td>Regex for the description of download requests.</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>

<h3 id="sample-requests">Sample Requests</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Get list of all downloads</td>
      <td>GET /v1/download/</td>
      <td><code class="highlighter-rouge">curl -Liv -X GET http://localhost:8080/v1/download</code></td>
    </tr>
    <tr>
      <td>Get list of downloads with description starting with a digit</td>
      <td>GET /v1/download/</td>
      <td><code class="highlighter-rouge">curl -Liv -X GET 'http://localhost:8080/v1/download?regex=^[0-9]'</code></td>
    </tr>
  </tbody>
</table>

<h2 id="remove-from-list">Remove from List</h2>

<p>Any aborted or finished download request can be removed from the <a href="#list-of-downloads">list of downloads</a> by making a <code class="highlighter-rouge">DELETE</code> request to <code class="highlighter-rouge">/v1/download/remove</code> with provided <code class="highlighter-rouge">id</code> (which is returned upon job creation).</p>

<h3 id="request-query-parameters-6">Request Query Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Optional?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>id</strong></td>
      <td><strong>string</strong></td>
      <td>Unique identifier of download job returned upon job creation.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h3 id="sample-request-6">Sample Request</h3>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Remove from list</td>
      <td>DELETE /v1/download/remove</td>
      <td><code class="highlighter-rouge">curl -Liv -X DELETE 'http://localhost:8080/v1/download/remove?id=5JjIuGemR'</code></td>
    </tr>
  </tbody>
</table>

  </div><a class="u-url" href="/aistore/downloader" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/aistore/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">AIStore - distributed object storage</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">AIStore - distributed object storage</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
