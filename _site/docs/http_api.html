<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>HTTP_API | AIStore - distributed object storage</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="HTTP_API" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore" />
<meta property="og:description" content="AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore" />
<link rel="canonical" href="http://localhost:4000/aistore/docs/http_api" />
<meta property="og:url" content="http://localhost:4000/aistore/docs/http_api" />
<meta property="og:site_name" content="AIStore - distributed object storage" />
<script type="application/ld+json">
{"headline":"HTTP_API","@type":"WebPage","url":"http://localhost:4000/aistore/docs/http_api","description":"AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/aistore/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/aistore/feed.xml" title="AIStore - distributed object storage" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/aistore/">AIStore - distributed object storage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">HTTP_API</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="" itemprop="datePublished">
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="restful-api">RESTful API</h2>

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#notation">Notation</a></li>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#api-reference">API Reference</a></li>
  <li><a href="#cloud-provider">Cloud Provider</a></li>
  <li><a href="#querying-information">Querying information</a></li>
  <li><a href="#example-querying-runtime-statistics">Example: querying runtime statistics</a></li>
</ul>

<h3 id="notation">Notation</h3>

<p>In this README:</p>

<blockquote>
  <p><code class="highlighter-rouge">G</code> - denotes a (hostname:port) address of a <strong>gateway</strong> (any gateway in a given AIS cluster)</p>
</blockquote>

<blockquote>
  <p><code class="highlighter-rouge">T</code> - (hostname:port) of a storage <strong>target</strong></p>
</blockquote>

<blockquote>
  <p><code class="highlighter-rouge">G-or-T</code> - (hostname:port) of <strong>any node</strong> member of the cluster</p>
</blockquote>

<h3 id="overview">Overview</h3>
<p>AIStore supports a growing number and variety of RESTful operations. To illustrate common conventions, let’s take a look at the example:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-X</span> GET http://G-or-T/v1/daemon?what<span class="o">=</span>config
</code></pre></div></div>

<p>This command queries one of the AIS nodes (denoted as <code class="highlighter-rouge">G-or-T</code>) for its configuration. The query - as well as most of other control plane queries - results in a JSON-formatted output that can be viewed with any compatible JSON viewer.</p>

<p>Notice the 4 (four) ubiquitous elements in the <code class="highlighter-rouge">curl</code> command line above:</p>

<ol>
  <li>HTTP verb aka method, one of: <code class="highlighter-rouge">PUT</code>, <code class="highlighter-rouge">GET</code>, <code class="highlighter-rouge">HEAD</code>, <code class="highlighter-rouge">POST</code>, or <code class="highlighter-rouge">DELETE</code>.</li>
</ol>

<p>In the example, it’s a GET but it can also be POST, PUT, and DELETE. For a brief summary of the standard HTTP verbs and their CRUD semantics, see, for instance, this <a href="http://www.restapitutorial.com/lessons/httpmethods.html">REST API tutorial</a>.</p>

<ol>
  <li>Hostname (or IPv4 address) and TCP port of one of the AIStore daemons.</li>
</ol>

<p>Most RESTful operations performed on an AIStore proxy/gateway will likely have a <em>clustered</em> scope. Exceptions may include querying proxy’s own configuration via <code class="highlighter-rouge">?what=config</code>, and more.</p>

<ol>
  <li>URL path: version of the REST API, RESTful <em>resource</em> that is operated upon, and possibly more forward-slash delimited specifiers.</li>
</ol>

<p>For example: /v1/cluster where <code class="highlighter-rouge">v1</code> is the currently supported API version and <code class="highlighter-rouge">cluster</code> is the (RESTful) resource. Other <em>resources</em> include:</p>

<table>
  <thead>
    <tr>
      <th>RESTful resource</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">cluster</code></td>
      <td>cluster-wide control-plane operation</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">daemon</code></td>
      <td>control-plane request to update or query specific AIS daemon (proxy or target)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">buckets</code></td>
      <td>create, destroy, rename and list bucket(s), get bucket names, get bucket properties</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">objects</code></td>
      <td>datapath request to GET, PUT and DELETE objects, read their properties</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">download</code></td>
      <td>download external resources (datasets, files) into cluster</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>Control message in the query string parameter, e.g. <code class="highlighter-rouge">?what=config</code>.</li>
</ol>

<blockquote>
  <p>Combined, all these elements tell the following story. They specify the most generic action (e.g., GET) and designate the target aka “resource” of this action: e.g., an entire cluster or a given daemon. Further, they may also include context-specific and query string encoded control message to, for instance, distinguish between getting system statistics (<code class="highlighter-rouge">?what=stats</code>) versus system configuration (<code class="highlighter-rouge">?what=config</code>).</p>
</blockquote>

<blockquote>
  <p>For developers and first-time users: if you deployed AIS locally having followed <a href="../README.md#local-non-containerized">these instructions</a> then most likely you will have <code class="highlighter-rouge">http://localhost:8080</code> as the primary proxy, and generally, <code class="highlighter-rouge">http://localhost:808x</code> for all locally-deployed AIS daemons.</p>
</blockquote>

<blockquote>
  <p>The reference below is “formulated” in <code class="highlighter-rouge">curl</code> - i.e., using <code class="highlighter-rouge">curl</code> command lines. It is possible, however, and often much easier (and, therefore, <strong>preferable</strong>), to execute the same operations using <a href="../cli/README.md">AIS CLI</a>.</p>
</blockquote>

<h3 id="api-reference">API Reference</h3>

<p>| Operation | HTTP action | Example |
|--- | --- | ---|
| Unregister storage target | DELETE /v1/cluster/daemon/daemonID | <code class="highlighter-rouge">curl -i -X DELETE 'http://G/v1/cluster/daemon/15205:8083'</code> |
| Register storage target | POST /v1/cluster/register | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"daemon_type": "target", "node_ip_addr": "172.16.175.41", "daemon_port": "8083", "daemon_id": "43888:8083", "direct_url": "http://172.16.175.41:8083"}' 'http://localhost:8083/v1/cluster/register'</code> |
| Register storage proxy | POST /v1/cluster/register | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"daemon_type": "proxy", "node_ip_addr": "172.16.175.41", "daemon_port": "8083", "daemon_id": "43888:8083", "direct_url": "http://172.16.175.41:8083"}' 'http://localhost:8083/v1/cluster/register'</code> |
| Set primary proxy (primary proxy only)| PUT /v1/cluster/proxy/new primary-proxy-id | <code class="highlighter-rouge">curl -i -X PUT 'http://G-primary/v1/cluster/proxy/26869:8080'</code> |
| Force-Set primary proxy (primary proxy)| PUT /v1/daemon/proxy/proxyID | <code class="highlighter-rouge">curl -i -X PUT -G 'http://G-primary/v1/daemon/proxy/23ef189ed'  --data-urlencode "frc=true" --data-urlencode "can=http://G-new-designated-primary"</code>  <sup id="a6"><a href="#ft6">6</a></sup>|
| Set AIS node configuration <strong>via JSON message</strong> | PUT {“action”: “setconfig”, “name”: “some-name”, “value”: “other-value”} /v1/daemon | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action": "setconfig","name": "stats_time", "value": "1s"}' 'http://G-or-T/v1/daemon'</code><br />• For the list of named options, see <a href="./configuration.md#runtime-configuration">runtime configuration</a> |
| Set AIS node configuration <strong>via URL query</strong> | PUT /v1/daemon/setconfig/?name1=value1&amp;name2=value2&amp;... | <code class="highlighter-rouge">curl -i -X PUT 'http://G-or-T/v1/daemon/setconfig?stats_time=33s&amp;log.loglevel=4'</code><br />• Allows to update multiple values in one shot<br />• For the list of named configuration options, see <a href="./configuration.md#runtime-configuration">runtime configuration</a> |
| Set cluster-wide configuration <strong>via JSON message</strong> (proxy) | PUT {“action”: “setconfig”, “name”: “some-name”, “value”: “other-value”} /v1/cluster | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action": "setconfig","name": "stats_time", "value": "1s"}' 'http://G/v1/cluster'</code><br />• Note below the alternative way to update cluster configuration<br />• For the list of named options, see <a href="./configuration.md#runtime-configuration">runtime configuration</a> |
| Set cluster-wide configuration <strong>via URL query</strong> (proxy) | PUT /v1/cluster/setconfig/?name1=value1&amp;name2=value2&amp;... | <code class="highlighter-rouge">curl -i -X PUT 'http://G/v1/cluster/setconfig?stats_time=33s&amp;log.loglevel=4'</code><br />• Allows to update multiple values in one shot<br />• For the list of named configuration options, see <a href="./configuration.md#runtime-configuration">runtime configuration</a> |
| Shutdown target/proxy | PUT {“action”: “shutdown”} /v1/daemon | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action": "shutdown"}' 'http://G-or-T/v1/daemon'</code> |
| Shutdown cluster (proxy) | PUT {“action”: “shutdown”} /v1/cluster | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action": "shutdown"}' 'http://G-primary/v1/cluster'</code> |
| Rebalance cluster (proxy) | PUT {“action”: “rebalance”, “value”: “start”} /v1/cluster | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action": "rebalance", "value": "start"}' 'http://G/v1/cluster'</code> |
| Abort global (automated or manually started) rebalance (proxy) | PUT {“action”: “rebalance”, “value”: “abort”} /v1/cluster | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action": "rebalance", "value": "abort"}' 'http://G/v1/cluster'</code> |
| Create ais <a href="bucket.md">bucket</a> (proxy) | POST {“action”: “createlb”} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action": "createlb"}' 'http://G/v1/buckets/abc'</code> |
| Destroy ais <a href="bucket.md">bucket</a> (proxy) | DELETE {“action”: “destroylb”} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X DELETE -H 'Content-Type: application/json' -d '{"action": "destroylb"}' 'http://G/v1/buckets/abc'</code> |
| Rename ais <a href="bucket.md">bucket</a> (proxy) | POST {“action”: “renamelb”} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action": "renamelb", "name": "newname"}' 'http://G/v1/buckets/oldname'</code> |
| Recover buckets <a href="bucket.md">bucket</a> (proxy) | POST {“action”: “recoverbck”} /v1/buckets?force=true | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action": "recoverbck"}' 'http://G/v1/buckets'</code> |
| Rename/move object (ais buckets) | POST {“action”: “rename”, “name”: new-name} /v1/objects/bucket-name/object-name | <code class="highlighter-rouge">curl -i -X POST -L -H 'Content-Type: application/json' -d '{"action": "rename", "name": "dir2/DDDDDD"}' 'http://G/v1/objects/mybucket/dir1/CCCCCC'</code> <sup id="a3"><a href="#ft3">3</a></sup> |
| Check if an object <em>is cached</em>  | HEAD /v1/objects/bucket-name/object-name | <code class="highlighter-rouge">curl -L --head 'http://G/v1/objects/mybucket/myobject?check_cached=true'</code> |
| Get object (proxy) | GET /v1/objects/bucket-name/object-name | <code class="highlighter-rouge">curl -L -X GET 'http://G/v1/objects/myS3bucket/myobject' -o myobject</code> <sup id="a1"><a href="#ft1">1</a></sup> |
| Read range (proxy) | GET /v1/objects/bucket-name/object-name?offset=&amp;length= | <code class="highlighter-rouge">curl -L -X GET 'http://G/v1/objects/myS3bucket/myobject?offset=1024&amp;length=512' -o myobject</code> |
| Get <a href="bucket.md">bucket</a> names | GET /v1/buckets/* | <code class="highlighter-rouge">curl -X GET 'http://G/v1/buckets/*'</code> |
| List objects in a given <a href="bucket.md">bucket</a> | POST {“action”: “listobjects”, “value”:{  properties-and-options... }} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -X POST -L -H 'Content-Type: application/json' -d '{"action": "listobjects", "value":{"props": "size"}}' 'http://G/v1/buckets/myS3bucket'</code> <sup id="a2"><a href="#ft2">2</a></sup> |
| Get <a href="bucket.md#properties-and-options">bucket properties</a> | HEAD /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -L --head 'http://G/v1/buckets/mybucket'</code> |
| Get object props | HEAD /v1/objects/bucket-name/object-name | <code class="highlighter-rouge">curl -L --head 'http://G/v1/objects/mybucket/myobject'</code> |
| Put object (proxy) | PUT /v1/objects/bucket-name/object-name | <code class="highlighter-rouge">curl -L -X PUT 'http://G/v1/objects/myS3bucket/myobject' -T filenameToUpload</code> |
| Put multi-part object (proxy) | PUT /v1/objects/bucket-name/object-name?appendty=append&amp;handle= | <code class="highlighter-rouge">curl -L -X PUT 'http://G/v1/objects/myS3bucket/myobject?appendty=append&amp;handle=' -T filenameToUpload-partN</code>  <sup><a href="#ft8">8</a></sup> |
| Finalize multi-part object (proxy) | PUT /v1/objects/bucket-name/object-name?appendty=flush&amp;handle=obj-handle | <code class="highlighter-rouge">curl -L -X PUT 'http://G/v1/objects/myS3bucket/myobject?appendty=flush&amp;handle=obj-handle'</code>  <sup><a href="#ft8">8</a></sup> |
| Delete object | DELETE /v1/objects/bucket-name/object-name | <code class="highlighter-rouge">curl -i -X DELETE -L 'http://G/v1/objects/mybucket/myobject'</code> |
| Delete a list of objects | DELETE ‘{“action”:”delete”, “value”:{“objnames”:”[o1[,o]]”[, deadline: string][, wait: bool]}}’ /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X DELETE -H 'Content-Type: application/json' -d '{"action":"delete", "value":{"objnames":["o1","o2","o3"], "deadline": "10s", "wait":true}}' 'http://G/v1/buckets/abc'</code> <sup><a href="#ft4">4</a></sup> |
| Delete a range of objects | DELETE ‘{“action”:”delete”, “value”:{“prefix”:”your-prefix”,”regex”:”your-regex”,”range”,”min:max” [, deadline: string][, wait:bool]}}’ /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X DELETE -H 'Content-Type: application/json' -d '{"action":"delete", "value":{"prefix":"__tst/test-", "regex":"\\d22\\d", "range":"1000:2000", "deadline": "10s", "wait":true}}' 'http://G/v1/buckets/abc'</code> <sup><a href="#ft4">4</a></sup> |
| Configure bucket as <a href="storage_svcs.md#n-way-mirror">n-way mirror</a> (proxy) | POST {“action”: “makencopies”, “value”: n} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action":"makencopies", "value": 2}' 'http://G/v1/buckets/abc'</code> |
| Enable <a href="storage_svcs.md#erasure-coding">erasure coding</a> protection for all objects (proxy) | POST {“action”: “ecencode”} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action":"ecencode"}' 'http://G/v1/buckets/abc'</code> |
| Set <a href="bucket.md#properties-and-options">bucket properties</a> (proxy) | PATCH {“action”: “setprops”} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action":"setprops", "value": {"cksum": {"type": "inherit"}, "mirror": {"enable": true}}' 'http://G/v1/buckets/abc'</code> |
| Reset <a href="bucket.md#properties-and-options">bucket properties</a> (proxy) | PUT {“action”: “resetprops”} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X PUT -H 'Content-Type: application/json' -d '{"action":"resetprops"}' 'http://G/v1/buckets/abc'</code> |
| <a href="bucket.md#prefetchevict-objects">Prefetch</a> a list of objects | POST ‘{“action”:”prefetch”, “value”:{“objnames”:”[o1[,o]]”[, deadline: string][, wait: bool]}}’ /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action":"prefetch", "value":{"objnames":["o1","o2","o3"], "deadline": "10s", "wait":true}}' 'http://G/v1/buckets/abc'</code> <sup><a href="#ft4">4</a></sup> |
| <a href="bucket.md#prefetchevict-objects">Prefetch</a> a range of objects| POST ‘{“action”:”prefetch”, “value”:{“prefix”:”your-prefix”,”regex”:”your-regex”,”range”,”min:max” [, deadline: string][, wait:bool]}}’ /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action":"prefetch", "value":{"prefix":"__tst/test-", "regex":"\\d22\\d", "range":"1000:2000", "deadline": "10s", "wait":true}}' 'http://G/v1/buckets/abc'</code> <sup><a href="#ft4">4</a></sup> |
| <a href="bucket.md#prefetchevict-objects">Evict</a> object from cache | DELETE ‘{“action”: “evictobjects”}’ /v1/objects/bucket-name/object-name | <code class="highlighter-rouge">curl -i -X DELETE -L -H 'Content-Type: application/json' -d '{"action": "evictobjects"}' 'http://G/v1/objects/mybucket/myobject'</code> |
| <a href="bucket.md#evict-bucket">Evict</a> cloud bucket (proxy) | DELETE {“action”: “evictcb”} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X DELETE -H 'Content-Type: application/json' -d '{"action": "evictcb"}' 'http://G/v1/buckets/myS3bucket'</code> |
| <a href="bucket.md#prefetchevict-objects">Evict</a> a list of objects | DELETE ‘{“action”:”evictobjects”, “value”:{“objnames”:”[o1[,o]]”[, deadline: string][, wait: bool]}}’ /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X DELETE -H 'Content-Type: application/json' -d '{"action":"evictobjects", "value":{"objnames":["o1","o2","o3"], "deadline": "10s", "wait":true}}' 'http://G/v1/buckets/abc'</code> <sup><a href="#ft4">4</a></sup> |
| <a href="bucket.md#prefetchevict-objects">Evict</a> a range of objects| DELETE ‘{“action”:”evictobjects”, “value”:{“prefix”:”your-prefix”,”regex”:”your-regex”,”range”,”min:max” [, deadline: string][, wait:bool]}}’ /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X DELETE -H 'Content-Type: application/json' -d '{"action":"evictobjects", "value":{"prefix":"__tst/test-", "regex":"\\d22\\d", "range":"1000:2000", "deadline": "10s", "wait":true}}' 'http://G/v1/buckets/abc'</code> <sup><a href="#ft4">4</a></sup> |
| Disable mountpath (target) | POST {“action”: “disable”, “value”: “/existing/mountpath”} /v1/daemon/mountpaths | <code class="highlighter-rouge">curl -X POST -L -H 'Content-Type: application/json' -d '{"action": "disable", "value":"/mount/path"}' 'http://T/v1/daemon/mountpaths'</code><sup><a href="#ft5">5</a></sup> |
| Enable mountpath (target) | POST {“action”: “enable”, “value”: “/existing/mountpath”} /v1/daemon/mountpaths | <code class="highlighter-rouge">curl -X POST -L -H 'Content-Type: application/json' -d '{"action": "enable", "value":"/mount/path"}' 'http://T/v1/daemon/mountpaths'</code><sup><a href="#ft5">5</a></sup> |
| Add mountpath (target) | PUT {“action”: “add”, “value”: “/new/mountpath”} /v1/daemon/mountpaths | <code class="highlighter-rouge">curl -X PUT -L -H 'Content-Type: application/json' -d '{"action": "add", "value":"/mount/path"}' 'http://T/v1/daemon/mountpaths'</code> |
| Remove mountpath from target | DELETE {“action”: “remove”, “value”: “/existing/mountpath”} /v1/daemon/mountpaths | <code class="highlighter-rouge">curl -X DELETE -L -H 'Content-Type: application/json' -d '{"action": "remove", "value":"/mount/path"}' 'http://T/v1/daemon/mountpaths'</code> |
| Promote file/directory(proxy) | POST {“action”: “promote”, “name”: “/home/user/dirname”, “value”: {“target”: “234ed78”, “trim_prefix”: “/home/user/”, “recurs”: true}} /v1/buckets/bucket-name | <code class="highlighter-rouge">curl -i -X POST -H 'Content-Type: application/json' -d '{"action":"promote", "name":"/user/dir", "value": {"target": "234ed78", "trim_prefix": "/user/", "recurs": true} }' 'http://G/v1/buckets/abc'</code> <sup><a href="#ft7">7</a></sup>|
___</p>

<p><a name="ft1">1</a>: This will fetch the object “myS3object” from the bucket “myS3bucket”. Notice the -L - this option must be used in all AIStore supported commands that read or write data - usually via the URL path /v1/objects/. For more on the -L and other useful options, see <a href="https://ec.haxx.se/http-redirects.html">Everything curl: HTTP redirect</a>.</p>

<p><a name="ft2">2</a>: See the <a href="bucket.md#list-bucket">List Bucket section</a> for details. <a href="#a2">↩</a></p>

<p><a name="ft3">3</a>: Notice the -L option here and elsewhere. <a href="#a3">↩</a></p>

<p><a name="ft4">4</a>: See the <a href="batch.md#listrange-operations">List/Range Operations section</a> for details.</p>

<p><a name="ft5">5</a>: The request returns an HTTP status code 204 if the mountpath is already enabled/disabled or 404 if mountpath was not found.</p>

<p><a name="ft6">6</a>: Advanced usage only. Use it to reassign the primary <em>role</em> administratively or if a cluster ever gets in a so-called <a href="https://en.wikipedia.org/wiki/Split-brain_(computing)">split-brain mode</a>. <a href="#a6">↩</a></p>

<p><a name="ft7">7</a>: The request promotes files to objects; note that the files must be present inside AIStore targets and be referenceable via local directories or fully qualified names. The example request promotes recursively all files of a directory <code class="highlighter-rouge">/user/dir</code> that is on the target with ID <code class="highlighter-rouge">234ed78</code> to objects of a bucket <code class="highlighter-rouge">abc</code>. As <code class="highlighter-rouge">trim_prefix</code> is set, the names of objects are the file paths with the base trimmed: <code class="highlighter-rouge">dir/file1</code>, <code class="highlighter-rouge">dir/file2</code>, <code class="highlighter-rouge">dir/subdir/file3</code> etc.</p>

<p><a name="ft8">8</a>: When putting the first part of an object, <code class="highlighter-rouge">handle</code> value must be empty string or omitted. On success, the first request returns an object handle. The subsequent <code class="highlighter-rouge">AppendObject</code> and <code class="highlighter-rouge">FlushObject</code> requests must pass the handle to the API calls. The object gets accessible and appears in a bucket only after <code class="highlighter-rouge">FlushObject</code> is done.</p>

<h3 id="cloud-provider">Cloud Provider</h3>

<p>Any storage bucket that AIS handles may originate in a 3rd party Cloud, or in another AIS cluster, or - the 3rd option - be created (and subsequently filled-in) in the AIS itself. But what if there’s a pair of buckets, a Cloud-based and, separately, an AIS bucket that happen to share the same name? To resolve all potential naming, and (arguably, more importantly) partition namespace with respect to both physical isolation and QoS, AIS introduces the concept of <em>provider</em>.</p>

<ul>
  <li><a href="./providers.md">Cloud Provider</a> - an abstraction, and simultaneously an API-supported option, that allows to delineate between “remote” and “local” buckets with respect to a given AIS cluster.</li>
</ul>

<blockquote>
  <p>Cloud provider (aka “bucket provider”) is realized as an optional parameter across all AIStore APIs that handle access to user data and bucket configuration. The list (of those APIs) includes GET, PUT, DELETE and <a href="batch.md">Range/List</a> operations. Supported providers, on the other hand, are enumerated and documented: <code class="highlighter-rouge">ais</code> - for AIS buckets, <code class="highlighter-rouge">aws</code>, or <code class="highlighter-rouge">gcp</code> - for S3 and Google Cloud buckets, respectively.</p>
</blockquote>

<p>In all those cases users can add an optional <code class="highlighter-rouge">?provider=ais</code> or <code class="highlighter-rouge">?provider=aws</code> or <code class="highlighter-rouge">?provider=gcp</code> query to the GET (PUT, DELETE, List/Range) request.</p>

<p>Curl example: <code class="highlighter-rouge">curl -L -X GET 'http://G/v1/objects/myS3bucket/myobject?provider=ais'</code></p>

<p>For more information, CLI examples, and the most recent updates, please see:</p>
<ul>
  <li><a href="./providers.md">Cloud Providers</a></li>
  <li><a href="/cli/resources/bucket.md">CLI: operations on buckets</a></li>
  <li><a href="/cli/resources/object.md">CLI: operations on objects</a></li>
  <li><a href="./on-disk-layout.md">On-Disk Layout</a></li>
</ul>

<h4 id="supported-apis">Supported APIs</h4>

<table>
  <thead>
    <tr>
      <th>RESTful verb</th>
      <th>AIS APIs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>GET object, Read range, Get bucket names</td>
    </tr>
    <tr>
      <td>PUT</td>
      <td>PUT object, APPEND object, Set single bucket property, Set bucket properties</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>DELETE object, DELETE list of objects, DELETE range of objects</td>
    </tr>
    <tr>
      <td>HEAD</td>
      <td>Get bucket properties, Get object properties</td>
    </tr>
  </tbody>
</table>

<h3 id="querying-information">Querying information</h3>

<p>AIStore provides an extensive list of RESTful operations to retrieve cluster current state:</p>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>HTTP action</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Get cluster map</td>
      <td>GET /v1/daemon</td>
      <td><code class="highlighter-rouge">curl -X GET http://G/v1/daemon?what=smap</code></td>
    </tr>
    <tr>
      <td>Get proxy/target configuration</td>
      <td>GET /v1/daemon</td>
      <td><code class="highlighter-rouge">curl -X GET http://G-or-T/v1/daemon?what=config</code></td>
    </tr>
    <tr>
      <td>Get proxy/target snode</td>
      <td>GET /v1/daemon</td>
      <td><code class="highlighter-rouge">curl -X GET http://G-or-T/v1/daemon?what=snode</code></td>
    </tr>
    <tr>
      <td>Get proxy/target status</td>
      <td>GET /v1/daemon</td>
      <td><code class="highlighter-rouge">curl -X GET http://G-or-T/v1/daemon?what=status</code></td>
    </tr>
    <tr>
      <td>Get cluster statistics (proxy)</td>
      <td>GET /v1/cluster</td>
      <td><code class="highlighter-rouge">curl -X GET http://G/v1/cluster?what=stats</code></td>
    </tr>
    <tr>
      <td>Get target statistics</td>
      <td>GET /v1/daemon</td>
      <td><code class="highlighter-rouge">curl -X GET http://T/v1/daemon?what=stats</code></td>
    </tr>
    <tr>
      <td>Get process info for all nodes in cluster (proxy)</td>
      <td>GET /v1/cluster</td>
      <td><code class="highlighter-rouge">curl -X GET http://G/v1/cluster?what=sysinfo</code></td>
    </tr>
    <tr>
      <td>Get proxy/target system info</td>
      <td>GET /v1/daemon</td>
      <td><code class="highlighter-rouge">curl -X GET http://G-or-T/v1/daemon?what=sysinfo</code></td>
    </tr>
    <tr>
      <td>Get xactions’ statistics (proxy) <a href="/xaction/README.md">More</a></td>
      <td>GET /v1/cluster</td>
      <td><code class="highlighter-rouge">curl -i -X GET  -H 'Content-Type: application/json' -d '{"action": "stats", "name": "xactionname", "value":{"bucket":"bckname"}}' 'http://G/v1/cluster?what=xaction'</code></td>
    </tr>
    <tr>
      <td>Get list of target’s filesystems (target)</td>
      <td>GET /v1/daemon?what=mountpaths</td>
      <td><code class="highlighter-rouge">curl -X GET http://T/v1/daemon?what=mountpaths</code></td>
    </tr>
    <tr>
      <td>Get list of all targets’ filesystems (proxy)</td>
      <td>GET /v1/cluster?what=mountpaths</td>
      <td><code class="highlighter-rouge">curl -X GET http://G/v1/cluster?what=mountpaths</code></td>
    </tr>
    <tr>
      <td>Get bucket list from a given target</td>
      <td>GET /v1/daemon</td>
      <td><code class="highlighter-rouge">curl -X GET http://T/v1/daemon?what=bucketmd</code></td>
    </tr>
  </tbody>
</table>

<h3 id="example-querying-runtime-statistics">Example: querying runtime statistics</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-X</span> GET http://G/v1/cluster?what<span class="o">=</span>stats
</code></pre></div></div>

<p>This single command causes execution of multiple <code class="highlighter-rouge">GET ?what=stats</code> requests within the AIStore cluster, and results in a JSON-formatted consolidated output that contains both http proxy and storage targets request counters, as well as per-target used/available capacities. For example:</p>

<p><img src="images/ais-get-stats.png" alt="AIStore statistics" width="256" /></p>

<p>More usage examples can be found in the <a href="configuration.md">README that describes AIS configuration</a>.</p>

  </div><a class="u-url" href="/aistore/docs/http_api" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/aistore/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">AIStore - distributed object storage</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">AIStore - distributed object storage</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>AIStore is a lightweight object storage system with the capability to linearly scale-out with each added storage node and a special focus on petascale deep learning. See more at: github.com/NVIDIA/aistore
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
